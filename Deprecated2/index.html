<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" type="text/css" href="style.css"></link>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.5.0/model-viewer.min.js"></script>
</head>
<body>
    <div class="header">
        <div class="organization">Kyoungpook National University</div>
        <div class="sitename">Building 3D View</div>
    </div>
    <div class="body">
        <div class="viewer">
            <model-viewer src="IT5-B1.glb" target="0m 1m 0m" camera-controls></model-viewer>
        </div>
        <div class="navigationBar">
            <div class="level">4층</div>
            <div class="level">3층</div>
            <div class="level">2층</div>
            <div class="level">1층</div>
            <div class="level">지하 1층</div>
        </div>
    </div>
    <div class="footer">
        Kyoungpook Nat'l University 41566 대구광역시 북구 대학로 80 (산격동,경북대학교) 학교안내전화 053-950-5114, 당직실 053-950-6000
        Copyright(c) Kyungpook National University. All rights reserved.
    </div>
    
    
    
    
    
    
    <model-viewer id="manifold" camera-controls touch-action="pan-y" src="./IT5-B1.glb" ar alt="A 3D model of a stick and ball">
        <div class="controls">
            <div>Mesh Variants:
                <select id="textures">
                    <option value="b1">B1</option>
                    <option value="1f">1F</option>
                    <option value="2f">2F</option>
                    <option value="3f">3F</option>
                    <option value="4f">4F</option>
                    <option value="5f">5F</option>
                </select>
            </div>
            
            <script type="module">
                const mvTextures = document.querySelector("model-viewer#manifold");
                const textures = document.querySelector("#textures");
                
                mvTextures.addEventListener("load", () => {
                    function updateAlphaValue(texture, alpha) {
                        const pbr = texture.pbrMetallicRoughness;
                        const baseColor = pbr.baseColorFactor;
                        baseColor[3] = alpha;
                        pbr.setBaseColorFactor(baseColor);
                    }
                    
                    textures.addEventListener("input", (event) => {
                        const selectedValue = event.target.value;
                        const b1 = mvTextures.model.getMaterialByName("B1");
                        const f1 = mvTextures.model.getMaterialByName("1F");
                        const f2 = mvTextures.model.getMaterialByName("2F");
                        const f3 = mvTextures.model.getMaterialByName("3F");
                        const f4 = mvTextures.model.getMaterialByName("4F");
                        const f5 = mvTextures.model.getMaterialByName("5F");
                        b1.setAlphaMode("BLEND");
                        f1.setAlphaMode("BLEND");
                        f2.setAlphaMode("BLEND");
                        f3.setAlphaMode("BLEND");
                        f4.setAlphaMode("BLEND");
                        f5.setAlphaMode("BLEND");

                        const animationDuration = 1000; // 1 second
                        const startTimestamp = performance.now();
                        function animate(currentTimestamp) {
                            const elapsed = currentTimestamp - startTimestamp;
                            
                            const delta = elapsed / animationDuration;
                            const alpha = selectedValue === "b1" ? 1 - delta : delta;
                            updateAlphaValue(b1, alpha);
                            updateAlphaValue(f1, 1 - alpha);
                            updateAlphaValue(f2, 1 - alpha);
                            updateAlphaValue(f3, 1 - alpha);
                            updateAlphaValue(f4, 1 - alpha);
                            updateAlphaValue(f5, 1 - alpha);
                            
                            if (elapsed < animationDuration) {
                                requestAnimationFrame(animate);
                            }
                        }
                        
                        requestAnimationFrame(animate);
                    });
                });
            </script>
        </div></model-viewer>
        
        
        
        
        
        
    </body>
    </html>
    <!--https://modelviewer.dev/examples/scenegraph/#changeMaterial-->